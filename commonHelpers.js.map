{"version":3,"file":"commonHelpers.js","sources":["../src/js/pixabay-api.js","../src/js/render-functions.js","../src/main.js"],"sourcesContent":["'use strict';\n\nimport axios from 'axios';\n\nconst API_KEY = '23963114-6d0d5d874ae460d9125bacd21';\nconst BASE_URL = 'https://pixabay.com/api/';\n\nlet page = 1;\n\nexport async function fetchImages(query, resetPage = false) {\n  if (resetPage) {\n    page = 1;\n  }\n\n  const url = `${BASE_URL}?key=${API_KEY}&q=${encodeURIComponent(query)}&image_type=photo&orientation=horizontal&safesearch=true&per_page=15&page=${page}`;\n\n  try {\n    const response = await axios.get(url);\n    if (response.status !== 200) {\n      throw new Error(`Error: ${response.statusText}`);\n    }\n\n    page += 1;\n    return response.data;\n  } catch (error) {\n    console.error('Fetch error:', error);\n    return { hits: [], totalHits: 0 };\n  }\n}","'use strict';\n\nimport iziToast from 'izitoast';\nimport 'izitoast/dist/css/iziToast.min.css';\nimport simpleLightbox from 'simplelightbox';\nimport 'simplelightbox/dist/simple-lightbox.min.css';\n\n\nlet lightbox;\nconst container = document.querySelector('.container');\nconst gallery = document.querySelector('.gallery');\nconst loader = document.getElementById('loader');\nconst loadMoreButton = document.getElementById('load-more');\n\nexport function renderImages(images) {\n  const imageMarkup = images\n    .map(\n      img => `<li class=\"gallery-item\">\n      <a class=\"gallery-link\" href=\"${img.webformatURL}\">\n        <img \n          class=\"gallery-image\" \n          width=\"360\"\n          src=\"${img.largeImageURL}\" \n          alt=\"${img.tags}\" \n        />\n      </a>\n      <ul class='description'>\n        <li class=\"info-title\"><strong>Likes</strong><span class=\"info-text\"> ${img.likes}</span></li>\n        <li class=\"info-title\"><strong>Views</strong><span class=\"info-text\"> ${img.views}</span></li>\n        <li class=\"info-title\"><strong>Comments</strong><span class=\"info-text\"> ${img.comments}</span></li>\n        <li class=\"info-title\"><strong>Downloads</strong><span class=\"info-text\"> ${img.downloads}</span></li>\n      </ul>\n    </li>`\n    )\n    .join('');\n\n  gallery.insertAdjacentHTML('beforeend', imageMarkup);\n}\n\nexport function showError(message) {\n  iziToast.error({\n    title: 'Error',\n    message: message,\n  });\n}\n\nexport function clearGallery() {\n  gallery.innerHTML = '';\n}\n\nexport function showLoader() {\n  loader.style.display = 'block';\n}\n\nexport function hideLoader() {\n  loader.style.display = 'none';\n}\n\nexport function showLoadMoreButton() {\n  loadMoreButton.style.display = 'block';\n}\n\nexport function hideLoadMoreButton() {\n  loadMoreButton.style.display = 'none';\n}\n\nexport function initializeLightbox() {\n  lightbox = new simpleLightbox('.gallery a', {\n    captionsData: 'alt',\n    captionDelay: 250,\n  });\n}\n\nexport function refreshLightbox() {\n  if (lightbox) {\n    lightbox.refresh();\n  } else {\n    initializeLightbox();\n  }\n}\n\nexport function scrollPage() {\n  const { height: cardHeight } = gallery.firstElementChild.getBoundingClientRect();\n  window.scrollBy({\n    top: cardHeight * 2,\n    behavior: 'smooth',\n  });\n}","'use strict';\n\nimport { fetchImages } from './js/pixabay-api';\nimport {\n  renderImages,\n  showError,\n  clearGallery,\n  showLoader,\n  hideLoader,\n  initializeLightbox,\n  refreshLightbox,\n  showLoadMoreButton,\n  hideLoadMoreButton,\n  scrollPage\n} from './js/render-functions';\n\nconst form = document.querySelector('.form');\nconst searchInput = document.querySelector('.search-input');\nconst loadMoreButton = document.getElementById('load-more');\nconst loadingText = document.getElementById('loading-text');\n\ndocument.querySelector('#load-more').textContent = 'Load more';\n\nlet currentQuery = '';\nlet totalHits = 0; \nlet loadedHits = 0; \n\nform.addEventListener('submit', handleSubmit);\nloadMoreButton.addEventListener('click', handleLoadMore);\n\nasync function handleSubmit(event) {\n  event.preventDefault();\n\n  currentQuery = searchInput.value.trim();\n\n  if (!currentQuery) {\n    showError('Please enter a search term');\n    return;\n  }\n\n  clearGallery();\n  hideLoadMoreButton();\n  showLoader();\n  loadingText.style.display = 'block'; \n\n  try {\n    const data = await fetchImages(currentQuery, true);\n    totalHits = data.totalHits; \n    loadedHits = data.hits.length; \n\n    if (loadedHits === 0) {\n      showError('Sorry, there are no images matching your search query. Please try again!');\n    } else {\n      renderImages(data.hits);\n      refreshLightbox();\n\n      if (loadedHits < totalHits) { \n        showLoadMoreButton();\n      }\n    }\n  } catch (error) {\n    showError('An error occurred while fetching images');\n    console.error(error);\n  } finally {\n    hideLoader();\n    loadingText.style.display = 'none'; \n  }\n}\n\nasync function handleLoadMore() {\n  showLoader();\n  loadMoreButton.style.display = 'none'; \n  loadingText.style.display = 'block'; \n\n  try {\n    const data = await fetchImages(currentQuery);\n    loadedHits += data.hits.length;\n\n    renderImages(data.hits);\n    refreshLightbox();\n    scrollPage();\n\n    if (loadedHits >= totalHits) {\n      showError(\"We're sorry, but you've reached the end of search results.\");\n      hideLoadMoreButton();\n    } else {\n      showLoadMoreButton();\n    }\n  } catch (error) {\n    showError('An error occurred while fetching images');\n    console.error(error);\n  } finally {\n    hideLoader();\n    loadingText.style.display = 'none'; \n  }\n}\n\ndocument.addEventListener('DOMContentLoaded', smoothScroll);\n\nfunction smoothScroll() {\n  const galleryItem = document.querySelector('.gallery-item');\n  if (galleryItem) {\n    const galleryItemHeight = galleryItem.getBoundingClientRect().height;\n    window.scrollBy({\n      top: galleryItemHeight * 2,\n      behavior: 'smooth'\n    });\n  }\n}\n"],"names":["API_KEY","BASE_URL","page","fetchImages","query","resetPage","url","response","axios","error","lightbox","gallery","loader","loadMoreButton","renderImages","images","imageMarkup","img","showError","message","iziToast","clearGallery","showLoader","hideLoader","showLoadMoreButton","hideLoadMoreButton","initializeLightbox","simpleLightbox","refreshLightbox","scrollPage","cardHeight","form","searchInput","loadingText","currentQuery","totalHits","loadedHits","handleSubmit","handleLoadMore","event","data","smoothScroll","galleryItem","galleryItemHeight"],"mappings":"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"}